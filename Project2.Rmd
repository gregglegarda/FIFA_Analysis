---
title: "FIFA_Analysis"
author: "CrystalMeth"
date: "Nov 19, 2019"
output:
  html_document:
    number_sectiond: yes
    toc: yes
    toc_float:
      collapsed: no
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(include = F)
options(scientific=T, digits = 3) 
```

```{r basicfcn, include=F}
# can add quietly=T option to the require() function
loadPkg = function(x) { if (!require(x,character.only=T, quietly =T)) { install.packages(x,dep=T,repos="http://cran.us.r-project.org"); if(!require(x,character.only=T)) stop("Package not found") } }
```
### Introduction

### FIFA Dataset 

The FIFA dataset was collected in outerspace blhablah blah. Describe the dataset, where it came from, interesting topics.

```{r Q1, echo=FALSE, include=TRUE}
data <- read.csv("data.csv", check.names = FALSE, stringsAsFactors = FALSE)
```

#### Preparing and exploring the data
```{r echo=FALSE, include=TRUE}
str(data)
summary(data)
head(data)
```

### Smart Question 1 (BIN)
#### How can we predict a dream team by determining the optimal skills(strength, heading, kick, jump) and vcharacteristics( leftfooted, bodytype, vision)in certain positions? And who would be the best players for the position?

```{r S1, echo=FALSE, include=TRUE}
#TEST used: Classification (KNN, Decision trees)
```


```{r}
library(tidyverse)
library(ggplot2)

```


```{r}
fifa <- read.csv('data-2.csv')
```


```{r}
positions_names <- c("LS", "ST", "RS", "LW", "LF", "CF", "RF", "RW", "LAM", "CAM", "RAM", "LM", "LCM", "CM", "RCM", "RM", "LWB", "LDM", "CDM", "RDM", "RWB", "LB", "LCB", "CB", "RCB", "RB")
skills_names <- c("Crossing", "Finishing", "HeadingAccuracy", "ShortPassing", "Volleys", "Dribbling", "Curve", "FKAccuracy", "LongPassing", "BallControl", "Acceleration", "SprintSpeed", "Agility", "Reactions", "Balance", "ShotPower", "Jumping", "Stamina", "Strength", "LongShots", "Aggression", "Interceptions", "Positioning", "Vision", "Penalties", "Composure", "Marking", "StandingTackle", "SlidingTackle", "GKDiving", "GKHandling", "GKKicking", "GKPositioning", "GKReflexes")
```

```{r}
for (position in positions_names) {
  fifa[position] <- lapply(fifa[position], function(rating){
    as.integer(substr(rating, 0, 2))
  })
}
```


```{r}
fifa_players <- na.omit(fifa[c(positions_names, skills_names)])
```


```{r}
middle <- c("LAM", "CAM", "RAM", "LM", "LCM", "CM", "RCM", "RM", "LDM", "CDM", "RDM")
left <- c("LS", "LW", "LF", "LAM", "LM", "LCM", "LWB", "LDM", "LB", "LCB")
right <- c("RS", "RF", "RW", "RAM", "RCM", "RM", "RDM", "RWB", "RCB", "RB")
```


```{r}
middle_players <- fifa_players[c(middle, skills_names)]
left_players <- fifa_players[c(left, skills_names)]
right_players <- fifa_players[c(right, skills_names)]
```
```{r}
head(middle_players)

```

```{r}
middle_players$value <- (middle_players$LAM + middle_players$CAM + middle_players$RAM + middle_players$LM + middle_players$LCM + middle_players$CM + middle_players$RCM + middle_players$RM + middle_players$LDM + middle_players$CDM + middle_players$RDM)/11
middle_players$value <- round(middle_players$value)
head(middle_players)
```


```{r}
middle_players_skills <- middle_players[-c(1:11, 46)]
head(middle_players_skills)
```

```{r}
middle_players_skills_scale = data.frame(scale(middle_players_skills))
head(middle_players_skills_scale)
```




```{r}
mps.pr.out =prcomp(middle_players_skills_scale, scale =TRUE)
summary(mps.pr.out)
mps.pr.out$rotation
```

```{r}
biplot(mps.pr.out, scale = 0)
```


```{r}
plot(mps.pr.out, type="l")
```

```{r}
mps.pr.var <- (mps.pr.out$sdev^2)
mps.pve <- mps.pr.var/sum(mps.pr.var)
plot(cumsum(mps.pve), xlab="Principal Component (standardized)", ylab ="Cumulative Proportion of Variance Explained",ylim=c(0,1),type="b")
```



```{r}
head(middle_players_skills_scale)
```

```{r}
mps.pr.out$rotation
```

```{r}
mp.pca <- cbind(middle_players[46], data.frame(mps.pr.out$x))
head(mp.pca)
```

```{r}
mp.pcr1 <- lm(value ~., data = mp.pca)
summary(mp.pcr1)
```

```{r}
mp.pcr2 <- lm(value ~ PC1 + PC2 + PC3, data = mp.pca)
summary(mp.pcr2)
```

```{r}
anova(mp.pcr1, mp.pcr2)
```

### Smart Question 2 (RUSSELL)
#### What variables contribute most to a player’s amount of penalties? How does Aggression, Composure affect the number of Penalties they receive 
```{r S2, echo=FALSE, include=TRUE}


```




### Smart Question 3 (CURTIS)
#### What variables contribute the most to a goalkeeper’s potential? Age, physical factors, current gk skills, etc... 
```{r S3, echo=FALSE, include=TRUE}
#TEST used:  multivariate regression


```




### Smart Question 4 (GREGG)
#### How do specific Skill Sets/ Characteristics affect a players wage? How about value? Can we say Skills are a good predictor of Wage and value?
```{r S4, echo=FALSE, include=TRUE}
#TEST used: 
#Wage - do PCA/PCR to find out the attributes that explain it the most
#Value- do PCA/PCR to find out the attributes that explain it the most
#Skill/Characteristics - classify the most important attributes into skills and characteristics
#Make sure p values are good
#Use the model to predict. Use multvariable regression









```




### Smart Question 5 (JAY)
#### How do physical factors (age, preferred foot, overall skill, international reputation, position in the field, weight, and height) help the soccer professionals to get wage for higher 100,000 Euro per week?
```{r S5, echo=FALSE, include=TRUE}
#Wage(Factor) – 1 (Higher 100k euro per week), 0 (lower 100k euro per week).
#Age (Integer)
#Foot (Factor)
#Skill (Integer)
#Weight (Integer)
#Height (Integer)
#International reputation (Factor) – 5 level.
#Position (Factor) – 4 types, including Goalkeeper, defense, midfield, and attack.

```
