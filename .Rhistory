#QQ plot
qqnorm(fifa$Penalties,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Penalties, col="steelblue", lwd=2)
qqnorm(fifa$Aggression,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Aggression, col="steelblue", lwd=2)
qqnorm(fifa$Age,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Age, col="steelblue", lwd=2)
qqnorm(fifa$Stamina,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Stamina, col="steelblue", lwd=2)
qqnorm(fifa$ShotPower,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$ShotPower, col="steelblue", lwd=2)
qqnorm(fifa$ShotPower,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$ShotPower, col="steelblue", lwd=2)
qqnorm(fifa$Balance,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Balance, col="steelblue", lwd=2)
qqnorm(fifa$Balance,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Balance, col="steelblue", lwd=2)
shapiro.test(fifa$Penalties)
library(corrplot)
library(nortest)
library(corrplot)
loadPkg("nortest")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#subset data
fifacols <- c("Penalties", "Aggression","Age", "Stamina","ShotPower","Balance", "BallControl","LongPassing","HeadingAccuracy", "Strength")
fifa <- fifa[fifacols]
#histogram of Penalties
summary(fifa$Penalties)
sd(fifa$Penalties)
hist(fifa$Penalties, main="Histogram of Penalties", xlab="Skill in Penalties", ylab="Frequency", col=barcolors)
ad.test(fifa$Penalties)
#analog correlation matrix
M <- cor(fifa)
M
#graphical correlation matrix
corrplot(M, method="circle")
library(corrplot)
library(nortest)
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#subset data
fifacols <- c("Penalties", "Aggression","Age", "Stamina","ShotPower","Balance", "BallControl","LongPassing","HeadingAccuracy", "Strength")
fifa <- fifa[fifacols]
#histogram of Penalties
summary(fifa$Penalties)
sd(fifa$Penalties)
hist(fifa$Penalties, main="Histogram of Penalties", xlab="Skill in Penalties", ylab="Frequency", col=barcolors)
#QQ plot
qqnorm(fifa$Penalties,pch=1, frame=F, main ="Penalties Q-Q Plot", ylab="Penalties Quantiles")
qqline(fifa$Penalties, col="steelblue", lwd=2)
#analog correlation matrix
M <- cor(fifa)
M
#graphical correlation matrix
corrplot(M, method="circle")
library(corrplot)
library(nortest)
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#subset data
fifacols <- c("Penalties", "Aggression","Age", "Stamina","ShotPower","Balance", "BallControl","LongPassing","HeadingAccuracy", "Strength")
fifa <- fifa[fifacols]
#histogram of Penalties
summary(fifa$Penalties)
sd(fifa$Penalties)
hist(fifa$Penalties, main="Histogram of Penalties", xlab="Skill in Penalties", ylab="Frequency", col=barcolors)
#analog correlation matrix
M <- cor(fifa)
M
#graphical correlation matrix
corrplot(M, method="circle")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
mse <- mean(reg$residuals^2)
mse
#check residuals
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
#check residuals
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Regression Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
#check residuals
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Regression Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Regression Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
loadPkg("car")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
reg.res
loadPkg("car")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#add linear reg, calculate mse
reg <- lm(Penalties ~., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#add linear reg, calculate mse
reg <- lm(Penalties ~ ., data=fifa)
summary(reg)
vif(reg)
res <- resid(reg)
hist(res, main="Histogram of Residuals", xlab="Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#add linear reg, calculate mse
reg <- lm(Penalties ~ ., data=fifa)
summary(reg)
vif(reg)
res <- resid(reg)
hist(res, main="Histogram of Residuals", xlab="Residuals", ylab="Frequency", col=barcolors)
loadPkg("car")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#add linear reg, calculate mse
reg <- lm(Penalties ~ ., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Residuals", ylab="Frequency", col=barcolors)
<<<<<<< HEAD
knitr::opts_chunk$set(include = F)
options(scientific=T, digits = 3)
# can add quietly=T option to the require() function
loadPkg = function(x) { if (!require(x,character.only=T, quietly =T)) { install.packages(x,dep=T,repos="http://cran.us.r-project.org"); if(!require(x,character.only=T)) stop("Package not found") } }
library(readr)
fifa <- read_csv("data.csv")
str(fifa)
library(dplyr)
library(ggplot2)
library(maps)
overall_fifa <- fifa %>%
group_by(Nationality) %>%
summarise(Count = n(),
Avg_Overall = mean(Overall),
Avg_Potential = mean(Potential),
Avg_Pot_Diff = mean(Potential-Overall))
worldmap = map_data("world")
merged_fifa <- merge(x = worldmap, y = overall_fifa, by.x = "region", by.y = "Nationality", all.x = TRUE) %>% arrange(order)
ggplot(data = merged_fifa, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = Count)) +
labs(fill='Number of players')
loadPkg("pls")
#Reload data
data <- read.csv("data.csv", check.names = FALSE, stringsAsFactors = FALSE)
#drop NAs
fifa <- na.omit(data)
#keep numeric variables only
fifa <- fifa[, !sapply(fifa, is.character)]
#drop ID variable
fifa <- fifa[, c(-1, -2)]
library(corrplot)
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#subset data
fifacols <- c("Penalties", "Aggression","Age", "Stamina","ShotPower","Balance", "BallControl","LongPassing","HeadingAccuracy", "Strength")
fifa <- fifa[fifacols]
#histogram of Penalties
summary(fifa$Penalties)
sd(fifa$Penalties)
hist(fifa$Penalties, main="Histogram of Penalties", xlab="Skill in Penalties", ylab="Frequency", col=barcolors)
#summary correlation matrix
M <- cor(fifa)
M
#graphical correlation matrix
corrplot(M, method="circle")
loadPkg("car")
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#add linear reg, calculate mse
reg <- lm(Penalties ~ ., data=fifa)
summary(reg)
vif(reg)
reg.res <- resid(reg)
hist(reg.res, main="Histogram of Residuals", xlab="Residuals", ylab="Frequency", col=barcolors)
summary(fifa)
barcolors = c("green", "violet", "orange", "blue", "pink", "red", "yellow", "cyan")
#scale data
prscale <- prcomp(fifa, scale=TRUE)
#summary of scaled data
summary(prscale)
plot(prscale, main="PCA", type = "l", col=barcolors)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#plot coefficients
#coefplot(pcr.fit)
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
mean((pcr.pred - y.test)^2)
#linear regression MSE
mse <- mean(reg$residuals^2)
mse
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
mean((pcr.pred - y.test)^2)
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
sqrt(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2, colors=barcolors)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2, color=barcolors)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2)
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2, main="Penalties Prediction")
library(pls)
#PCR on training data using CV
smp_size <- floor(0.80 *nrow(fifa))
set.seed(2)
train_ind <- sample(seq_len(nrow(fifa)), size=smp_size)
fifa.train <- fifa[train_ind, ]
fifa.test <- fifa[-train_ind,]
y.test <- fifa.test[,1]
pcr.fit = pcr(Penalties ~., data=fifa.train, scale=TRUE, validation="CV")
summary(pcr.fit)
#plot validation
validationplot(pcr.fit, val.type="MSEP")
#calculate MSE
pcr.pred <- predict(pcr.fit, fifa.test, ncomp = 6)
#linear regression MSE
print("---------MSE Linear Regression---------")
mse <- mean(reg$residuals^2)
mse
print("---------MSE PCR ---------")
(mean((pcr.pred - y.test)^2))
#fit model
pcr.fit2 <- pcr(Penalties ~.,data=fifa, scale=TRUE, ncomp=6)
summary(pcr.fit2)
#show predicted values vs observed
predplot(pcr.fit2, main="Penalties Prediction Vs Penalties Observed")
knitr::opts_chunk$set(include = F)
options(scientific=T, digits = 3)
#Reload data
data <- read.csv("data.csv", check.names = FALSE, stringsAsFactors = FALSE)
#drop NAs
fifa <- na.omit(data)
#keep numeric variables only
fifa <- fifa[, !sapply(fifa, is.character)]
#drop ID variable
fifa <- fifa[, c(-1, -2)]
=======
>>>>>>> c8361b809a8233b66d129de07946b56d659cfbdd
>>>>>>> 42d4cac78199323aaf8300a2d9af202657cd7102
>>>>>>> d8595722be3c0fb296bc3ea052e8f2f94c7f65bf
>>>>>>> 0410b7b2ed59c47b9279e4bc0b4611235b48fdb8
>>>>>>> 9364b668e451ed52270717d9c9b37f74c94ff682
library(readxl)
DataTS <- read_excel("C:/Users/admin/Desktop/Third Semester/Development/paper/Data.xlsx")
View(DataTS)
#plot the series - GDPpc and Edu
library(forecast)
GDPpc.ts <- ts(DataTS$GDPpc, start = 1972)
plot.ts(GDPpc.ts, ylab = "Current $US", main="Thailand's GDP per capita")
Edu.ts <- ts(DataTS$Edu, start = 1972)
plot.ts(Edu.ts, ylab = "Percent of GDP", main="Government expenditure on education")
#Log transformation - Edu and GDPpc
log_GDPpc <- log(DataTS$GDPpc)
log_Edu <- log(DataTS$Edu)
#unit root test - Log_Edu and log_GDPpc
library(urca)
summary(ur.df(log_Edu, type = "drift", lags = 12, selectlags = c("AIC"))) #ADF-constant
summary(ur.df(log_GDPpc, type = "trend", lags = 12, selectlags = c("AIC"))) #ADF-trend
#calculate Difference of log_Edu and log_GDPpc
library(dplyr)
diff_log_Edu <- diff(log_Edu, lag = 1)
diff_log_GDPpc <- diff(log_GDPpc, lag = 1)
#unit root test - Diff_log_ME and Diff_log_GDP
library(urca)
summary(ur.df(diff_log_Edu, type = "none", lags = 12, selectlags = c("AIC"))) #ADF-none
summary(ur.df(diff_log_GDPpc, type = "drift", lags = 12, selectlags = c("AIC"))) #ADF-constant
# Engle Granger procedure
# step 1
Edu <- log_Edu.ts
GDPpc <- log_GDPpc.ts
Edu.GDPpc <- cbind(Edu, GDPpc)
## Estimate long run regression with constant
GDPpc.eq <- lm(GDPpc~Edu,data=Edu.GDPpc) #GDP - dependent variable
Edu.eq <- lm(Edu~GDPpc,data=Edu.GDPpc) #Edu - dependent variable
summary(GDPpc.eq)
summary(Edu.eq)
## Check residuals
#library(forecast)
checkresiduals(GDPpc.eq$residuals)
